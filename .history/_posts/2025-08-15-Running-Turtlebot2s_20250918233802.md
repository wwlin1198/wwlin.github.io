---
layout: post
title: "Using the Turtlebot2 Robot in ROS Melodic"
---

## Using the Turtlebot2 Robot in ROS Melodic


---

### Turtlebot2 Setup
This is to document how I setup and ran the turtlebot2 with ROS Melodic (18.04). I was still using ROS1 but I will include ROS2 but it will be the same as the github that I have found. 

PLEASE HAVE FETCH CONNECTED THROUGH ETHERNET IF BASE IS NOT NEEDED AS IT LOSES CONNECTION IF IT IS ON WIFI IF NOT ACTIVELY USED DURING DEVELOPMENT


#### Preliminaries
Before we start, make sure that all the workstations and robots have their own static IPs. If static IP is not implemented, please implement it using a separate router. Donâ€™t use a school's static IP as it provides unstable Connection. If you are running multi-robot setup on ROS1, please use run the command: export ROBOT_NAME. 

#### Installing Packages

#### Running the Turtlebots with Multi Master Fkie
Maybe Confusing Commands:
<div class="code-block-container">
  <div class="code-block-header">
    <span>Bash</span>
  </div>
  <pre><code class="language-bash">export ROS_MASTER_URI=http://&lt;other_robot_name_or_ip&gt;:11311</code></pre>
</div>
This should put in the IP of the other robot so when you run scripts, it runs on the robot with the run script. 

<div class="code-block-container">
  <div class="code-block-header">
    <span>Bash</span>
  </div>
  <pre><code class="language-bash">export ROS_IP=http://robot_A:11311</code></pre>
</div>
This would be the current IP of the laptop.

<ol>
  <li>
    <p>Run the minimal launch file:</p>
    <div class="code-block-container">
      <div class="code-block-header"><span>Bash</span></div>
      <pre><code class="language-bash">roslaunch turtlebot_bringup minimal.launch</code></pre>
    </div>
  </li>
  <li>
    <p>Discover the master:</p>
    <div class="code-block-container">
      <div class="code-block-header"><span>Bash</span></div>
      <pre><code class="language-bash">rosrun master_discovery_fkie master_discovery _mcast_group:=226.0.0.0</code></pre>
    </div>
  </li>
  <li>
    <p>Sync the master:</p>
    <div class="code-block-container">
      <div class="code-block-header"><span>Bash</span></div>
      <pre><code class="language-bash">rosrun master_sync_fkie master_sync</code></pre>
    </div>
    <blockquote>
      <p><em>Now you should see both the workstation computer and the TurtleBot's ROS masters. If not, check your connections again and make sure the IP addresses are correct.</em></p>
      <p><em>If you don't see a message called "Odom Recieved!", ensure you are using the correct camera. It should be the Astra camera.</em></p>
    </blockquote>
    <div class="code-block-container">
      <div class="code-block-header"><span>Bash</span></div>
      <pre><code class="language-bash">export TURTLEBOT_3D_SENSOR=astra</code></pre>
    </div>
  </li>
  <li>
    <p>Launch the Astra camera:</p>
    <div class="code-block-container">
      <div class="code-block-header"><span>Bash</span></div>
      <pre><code class="language-bash">roslaunch astra_camera astra.launch</code></pre>
    </div>
  </li>
  <li>
    <p>Start the navigation demo:</p>
    <div class="code-block-container">
      <div class="code-block-header"><span>Bash</span></div>
      <pre><code class="language-bash">roslaunch turtlebot_navigation amcl_demo.launch map_file:=[PATH TO MAP (should be a yaml)]</code></pre>
    </div>
    <p>For example, on turtlebot02:</p>
    <div class="code-block-container">
      <div class="code-block-header"><span>Bash</span></div>
      <pre><code class="language-bash">roslaunch turtlebot_navigation amcl_demo.launch map_file:=/home/turtlebot02/2_21_two_human_map.yaml</code></pre>
    </div>
  </li>
  <li>
    <p>Go back to your workstation.</p>
  </li>
  <li>
    <p>Launch RViz with the correct ROS Master URI and hostname:</p>
    <div class="code-block-container">
      <div class="code-block-header"><span>Bash</span></div>
      <pre><code class="language-bash">export ROS_MASTER_URI=http://192.168.1.123:11311
export ROS_HOSTNAME=10.110.177.60</code></pre>
    </div>
  </li>
  <li>
    <p>Launch the final test file. Example (This should be your main script):</p>
    <div class="code-block-container">
      <div class="code-block-header"><span>Bash</span></div>
      <pre><code class="language-bash">roslaunch warehouse_domain test_move_2h_id0.launch</code></pre>
    </div>
  </li>
</ol>


